/*!
 * Extensible 1.0.2
 * Copyright(c) 2010-2012 Extensible, LLC
 * licensing@ext.ensible.com
 * http://ext.ensible.com
 */
Ext.ensible.cal.CalendarCombo=Ext.extend(Ext.form.ComboBox,{fieldLabel:"Calendar",triggerAction:"all",mode:"local",forceSelection:true,selectOnFocus:true,width:200,defaultCls:"x-cal-default",initComponent:function(){var a=Ext.ensible.cal,b=a.CalendarMappings;a.CalendarCombo.superclass.initComponent.call(this);this.valueField=b.CalendarId.name;this.displayField=b.Title.name;this.tpl=this.tpl||'<tpl for="."><div class="x-combo-list-item x-cal-{'+b.ColorId.name+'}"><div class="ext-cal-picker-icon">&#160;</div>{'+this.displayField+"}</div></tpl>"},afterRender:function(){Ext.ensible.cal.CalendarCombo.superclass.afterRender.call(this);this.wrap=this.el.up(".x-form-field-wrap");this.wrap.addClass("ext-calendar-picker");this.icon=Ext.DomHelper.append(this.wrap,{tag:"div",cls:"ext-cal-picker-icon ext-cal-picker-mainicon"})},assertValue:function(){var b=this.getRawValue(),a=this.findRecord(this.displayField,b);if(!a&&this.forceSelection){if(b.length>0&&b!=this.emptyText){this.store.clearFilter();this.setValue(this.value);this.applyEmptyText()}else{this.clearValue()}}else{if(a){if(b==a.get(this.displayField)&&this.value==a.get(this.valueField)){return}b=a.get(this.valueField||this.displayField)}this.setValue(b)}},getStyleClass:function(a){if(a&&a!==""){var b=this.store.getById(a);return"x-cal-"+b.data[Ext.ensible.cal.CalendarMappings.ColorId.name]}},setValue:function(a){this.wrap.removeClass(this.getStyleClass(this.getValue()));a=a||this.store.getAt(0).data[Ext.ensible.cal.CalendarMappings.CalendarId.name];Ext.ensible.cal.CalendarCombo.superclass.setValue.call(this,a);this.wrap.addClass(this.getStyleClass(a))}});Ext.reg("extensible.calendarcombo",Ext.ensible.cal.CalendarCombo);