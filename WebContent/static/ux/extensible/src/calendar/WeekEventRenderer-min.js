/*!
 * Extensible 1.0.2
 * Copyright(c) 2010-2012 Extensible, LLC
 * licensing@ext.ensible.com
 * http://ext.ensible.com
 */
Ext.ensible.cal.WeekEventRenderer=function(){var a=function(c,d,i){var g=1,h=Ext.get(c+"-wk-"+d),f,e;if(h){e=h.child(".ext-cal-evt-tbl",true);f=e.tBodies[0].childNodes[i+g];if(!f){f=Ext.DomHelper.append(e.tBodies[0],"<tr></tr>")}}return Ext.get(f)};var b=function(f,l,d,e,c,h,g){var k=Ext.ensible.cal.EventMappings,n=f.data||f.event.data,o=h.clone(),p=o.add(Date.DAY,c-d).add(Date.MILLI,-1),i=a(g.viewId,l,e),m=Ext.ensible.Date.diffDays(h,n[k.EndDate.name])+1,j=Math.min(m,c-d);n._weekIndex=l;n._renderAsAllDay=n[k.IsAllDay.name]||f.isSpanStart;n.spanLeft=n[k.StartDate.name].getTime()<o.getTime();n.spanRight=n[k.EndDate.name].getTime()>p.getTime();n.spanCls=(n.spanLeft?(n.spanRight?"ext-cal-ev-spanboth":"ext-cal-ev-spanleft"):(n.spanRight?"ext-cal-ev-spanright":""));var q={tag:"td",cls:"ext-cal-ev",cn:g.tpl.apply(g.templateDataFn(n))};if(j>1){q.colspan=j}Ext.DomHelper.append(i,q)};return{render:function(u){var w=this,x="&#160;",r=0,h=u.eventGrid,i=u.viewStart.clone(),l="",m=u.tpl,p=u.maxEventsPerDay!=undefined?u.maxEventsPerDay:999,s=u.weekCount<1?6:u.weekCount,n=u.weekCount==1?u.dayCount:7,t,o,c,f,g,q,e,k,j,d;for(;r<s;r++){o=0;c=h[r];for(;o<n;o++){if(c&&c[o]){f=0;g=0;q=c[o];e=q.length;l=i.format("Ymd");for(;f<e;f++){if(!q[f]){if(f>=p){continue}t=a(u.viewId,r,f);Ext.DomHelper.append(t,{tag:"td",cls:"ext-cal-ev",html:x,id:u.viewId+"-empty-"+e+"-day-"+l})}else{if(f>=p){g++;continue}k=q[f];if(!k.isSpan||k.isSpanStart){b(k,r,o,f,n,i,u)}}}if(g>0){t=a(u.viewId,r,p);Ext.DomHelper.append(t,{tag:"td",cls:"ext-cal-ev-more",id:"ext-cal-ev-more-"+i.format("Ymd"),cn:{tag:"a",html:String.format(u.getMoreText(g),g)}})}else{if(e<u.evtMaxCount[r]){t=a(u.viewId,r,e);if(t){j={tag:"td",cls:"ext-cal-ev",html:x,id:u.viewId+"-empty-"+(e+1)+"-day-"+l};var v=u.evtMaxCount[r]-e;if(v>1){j.rowspan=v}Ext.DomHelper.append(t,j)}}}}else{t=a(u.viewId,r,0);if(t){j={tag:"td",cls:"ext-cal-ev",html:x,id:u.viewId+"-empty-day-"+l};if(u.evtMaxCount[r]>1){j.rowspan=u.evtMaxCount[r]}Ext.DomHelper.append(t,j)}}i=i.add(Date.DAY,1)}}}}}();