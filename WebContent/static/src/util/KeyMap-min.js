Ext.KeyMap=function(c,b,a){this.el=Ext.get(c);this.eventName=a||"keydown";this.bindings=[];if(b){this.addBinding(b)}this.enable()};Ext.KeyMap.prototype={stopEvent:false,addBinding:function(b){if(Ext.isArray(b)){Ext.each(b,function(j){this.addBinding(j)},this);return}var i=b.key,f=b.fn||b.handler,k=b.scope;if(b.stopEvent){this.stopEvent=b.stopEvent}if(typeof i=="string"){var g=[];var e=i.toUpperCase();for(var c=0,d=e.length;c<d;c++){g.push(e.charCodeAt(c))}i=g}var a=Ext.isArray(i);var h=function(n){if(this.checkModifiers(b,n)){var l=n.getKey();if(a){for(var m=0,j=i.length;m<j;m++){if(i[m]==l){if(this.stopEvent){n.stopEvent()}f.call(k||window,l,n);return}}}else{if(l==i){if(this.stopEvent){n.stopEvent()}f.call(k||window,l,n)}}}};this.bindings.push(h)},checkModifiers:function(b,g){var h,d,f=["shift","ctrl","alt"];for(var c=0,a=f.length;c<a;++c){d=f[c];h=b[d];if(!(h===undefined||(h===g[d+"Key"]))){return false}}return true},on:function(b,d,c){var g,a,e,f;if(typeof b=="object"&&!Ext.isArray(b)){g=b.key;a=b.shift;e=b.ctrl;f=b.alt}else{g=b}this.addBinding({key:g,shift:a,ctrl:e,alt:f,fn:d,scope:c})},handleKeyDown:function(f){if(this.enabled){var c=this.bindings;for(var d=0,a=c.length;d<a;d++){c[d].call(this,f)}}},isEnabled:function(){return this.enabled},enable:function(){if(!this.enabled){this.el.on(this.eventName,this.handleKeyDown,this);this.enabled=true}},disable:function(){if(this.enabled){this.el.removeListener(this.eventName,this.handleKeyDown,this);this.enabled=false}},setDisabled:function(a){this[a?"disable":"enable"]()}};