Ext.grid.PivotAxis=Ext.extend(Ext.Component,{orientation:"horizontal",defaultHeaderWidth:80,paddingWidth:7,setDimensions:function(a){this.dimensions=a},onRender:function(b,a){var c=this.orientation=="horizontal"?this.renderHorizontalRows():this.renderVerticalRows();this.el=Ext.DomHelper.overwrite(b.dom,{tag:"table",cn:c},true)},renderHorizontalRows:function(){var h=this.buildHeaders(),a=h.length,f=[],c,g,e,d,b;for(d=0;d<a;d++){c=[];g=h[d].items;e=g.length;for(b=0;b<e;b++){c.push({tag:"td",html:g[b].header,colspan:g[b].span})}f[d]={tag:"tr",cn:c}}return f},renderVerticalRows:function(){var b=this.buildHeaders(),h=b.length,a=[],l=[],g,c,k,f,e,d;for(e=0;e<h;e++){c=b[e];f=c.width||80;g=c.items.length;for(d=0;d<g;d++){k=c.items[d];a[k.start]=a[k.start]||[];a[k.start].push({tag:"td",html:k.header,rowspan:k.span,width:Ext.isBorderBox?f:f-this.paddingWidth})}}g=a.length;for(e=0;e<g;e++){l[e]={tag:"tr",cn:a[e]}}return l},getTuples:function(){var b=new Ext.data.Store({});b.data=this.store.data.clone();b.fields=this.store.fields;var k=[],a=this.dimensions,c=a.length,h;for(h=0;h<c;h++){k.push({field:a[h].dataIndex,direction:a[h].direction||"ASC"})}b.sort(k);var e=b.data.items,m=[],j=[],n,g,d,f,l;c=e.length;for(h=0;h<c;h++){d=this.getRecordInfo(e[h]);f=d.data;g="";for(l in f){g+=f[l]+"---"}if(m.indexOf(g)==-1){m.push(g);j.push(d)}}b.destroy();return j},getRecordInfo:function(a){var e=this.dimensions,d=e.length,g={},h,c,b;for(b=0;b<d;b++){h=e[b];c=h.dataIndex;g[c]=a.get(c)}var f=function(i){return function(j){for(var k in i){if(j.get(k)!=i[k]){return false}}return true}};return{data:g,matcher:f(g)}},buildHeaders:function(){var k=this.getTuples(),l=k.length,a=this.dimensions,e,q=a.length,c=[],n,r,m,p,o,b,h,g,f,d;for(f=0;f<q;f++){e=a[f];r=[];o=0;b=0;for(d=0;d<l;d++){n=k[d];h=d==(l-1);m=n.data[e.dataIndex];g=p!=undefined&&p!=m;if(f>0&&d>0){g=g||n.data[a[f-1].dataIndex]!=k[d-1].data[a[f-1].dataIndex]}if(g){r.push({header:p,span:o,start:b});b+=o;o=0}if(h){r.push({header:m,span:o+1,start:b});b+=o;o=0}p=m;o++}c.push({items:r,width:e.width||this.defaultHeaderWidth});p=undefined}return c}});